#!/bin/bash

## CONFIGURATION ##############################################################

# Command to start the locker (should not fork)
locker="i3lock -n -f -e -c 191b21"

# Delay in seconds.
sleep_delay=1

# Run before starting the locker
pre_lock() {
    xset dpms 0 0 10
    return
}

# Run after the locker exits
post_lock() {
    xset -dpms
    return
}

###############################################################################

pre_lock

# kill locker if we get killed
trap 'kill %%' TERM INT

if [[ -e /dev/fd/${XSS_SLEEP_LOCK_FD:--1} ]]; then
    $locker &
else
    $locker &

    sleep $sleep_delay

    xset dpms force off
fi

wait # for locker to exit

post_lock
